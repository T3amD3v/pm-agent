<!DOCTYPE html>
<html>
<head>
    <title>Project Task Generator</title>
</head>
<body>
    <form id="projectForm">
        <h2>Project Task Generator</h2>
        
        <label>Project Name:</label>
        <input type="text" id="projectName" required><br><br>
        
        <label>Project Description:</label>
        <textarea id="projectDescription" rows="5" cols="50" required></textarea><br><br>
        
        <label>Upload Project Files:</label>
        <input type="file" id="files" multiple><br><br>
        
        <label>Specific Requirements/Context:</label>
        <textarea id="requirements" rows="3" cols="50"></textarea><br><br>
        
        <button type="submit">Generate Task List</button>
    </form>

    <script>
        document.getElementById('projectForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData();
            
            // Add text fields
            formData.append('projectName', document.getElementById('projectName').value);
            formData.append('projectDescription', document.getElementById('projectDescription').value);
            formData.append('requirements', document.getElementById('requirements').value);
            
            // Add files
            const files = document.getElementById('files').files;
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const base64 = await convertToBase64(file);
                formData.append(`file_${i}`, base64);
                formData.append(`filename_${i}`, file.name);
            }
            formData.append('fileCount', files.length);
            
            // Send to n8n webhook
            try {
                const response = await fetch('https://trybl.app.n8n.cloud/webhook-test/project-tasks', {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                alert('Tasks generated successfully! Check your Google Sheet.');
            } catch (error) {
                alert('Error: ' + error.message);
            }
        });
        
        function convertToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
            });
        }
    </script>
</body>
</html>
